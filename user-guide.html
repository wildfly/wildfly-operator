<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>WildFly Operator - User Documentation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>WildFly Operator - User Documentation</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#basic-install">Basic Install (Phase I)</a></li>
<li><a href="#application-image">Specify the Docker Application Image</a></li>
<li><a href="#bootableJar">Specify a Bootable JAR application image</a></li>
<li><a href="#size">Specify the Size of the Application</a></li>
<li><a href="#resources">Specify the Resource requirements for the container</a></li>
<li><a href="#storage">Specify the Storage Requirements for the Server Data Directory</a></li>
<li><a href="#env">Configure the Application Environment</a></li>
<li><a href="#secret">Configure Secrets</a></li>
<li><a href="#configmaps">Configure ConfigMaps</a></li>
<li><a href="#standalone-config-map">Bring Your Own Standalone XML Configuration</a></li>
<li><a href="#_monitor_wildfly_metrics">Monitor WildFly Metrics</a></li>
<li><a href="#_openshift_features">OpenShift Features</a>
<ul class="sectlevel2">
<li><a href="#seamless-upgrades">Seamless Upgrades</a></li>
<li><a href="#http-route-creation">Creation of an HTTP Route</a></li>
</ul>
</li>
<li><a href="#scaledown-transaction-recovery">Transaction recovery during scaledown</a>
<ul class="sectlevel2">
<li><a href="#_transaction_scaledown_special_cases">Transaction scaledown special cases</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This guide documents the various features and capabilities provides by the WildFly Operator.</p>
</div>
<div class="paragraph">
<p>This guide is complemented by the <a href="./apis.html">API Documentation</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="basic-install">Basic Install (Phase I)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The features and capabilities of <strong>Basic Install (Phase I)</strong> deals with the provisioning, installation and configuration of a Java application managed by the WildFly Operator.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="application-image">Specify the Docker Application Image</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>applicationImage</code> specifies the Docker application image that contains the Java application.
The operator support two kind of application images:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>WildFly S2I Builder/Runtime application image. This application image is built by using <a href="https://github.com/wildfly/wildfly-s2i">WildFly S2I</a>. This is the default one.</p>
</li>
<li>
<p>Bootable Jar application image. This application image is built by using <a href="https://github.com/wildfly-extras/wildfly-jar-maven-plugin">Bootable JAR</a></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example of application image configuration</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spec:
  applicationImage: "quay.io/wildfly-quickstarts/wildfly-operator-quickstart:18.0"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>applicationImage</code> accepts different references to Docker image:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the name of the image: <code>quay.io/wildfly-quickstarts/wildfly-operator-quickstart</code></p>
</li>
<li>
<p>a tag: <code>quay.io/wildfly-quickstarts/wildfly-operator-quickstart:18.0</code></p>
</li>
<li>
<p>a digest: <code>quay.io/wildfly-quickstarts/wildfly-operator-quickstart@sha256:0af38bc38be93116b6a1d86a9c78bd14cd527121970899d719baf78e5dc7bfd2</code></p>
</li>
<li>
<p>an imagestream tag: <code>wildfly-operator-quickstart:latest</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Using an imatestream tag is supported only on OpenShift and the imagestream must be in the same namespace that the deployed <code>WildFlyServer</code> resource.
The WildFly Operator will trigger new deployment of the application whenever the image corresponding to the imagestream tag changes.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bootableJar">Specify a Bootable JAR application image</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>bootableJar</code> specifies whether the application image is a Bootable JAR server. If this configuration is unspecified, the WildFly Operator assumes that the application image is an S2I image.</p>
</div>
<div class="listingblock">
<div class="title">Example of Bootable JAR configuration</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spec:
  bootableJar: true</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are some restrictions about the base image you can use to launch the Bootable JAR:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The base image for the Bootable JAR container must be <code>registry.access.redhat.com/ubi8/openjdk-11</code> or any other Red Hat ubi8 supplying a higher JDK version.</p>
</li>
<li>
<p>The Bootable JAR must be built for a server configured for the cloud environment. This is done by enabling the <code>cloud</code> configuration item on the <code>wildfly-jar-maven-plugin</code> configuration. See <a href="https://docs.wildfly.org/bootablejar/#wildfly_jar_configuring_cloud">Configuring the server for cloud execution</a> on the <code>wildfly-jar-maven-plugin</code> documentation.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="size">Specify the Size of the Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>replicas</code> specifies the size of the application, i.e. the number of pods that runs the application image.</p>
</div>
<div class="listingblock">
<div class="title">Example of size configuration</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spec:
  replicas:2</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="resources">Specify the Resource requirements for the container</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>resources</code> spec is defined in the <a href="./apis.adoc#Resources">Resources API Documentation</a>.</p>
</div>
<div class="listingblock">
<div class="title">Example of resources configuration</div>
<div class="content">
<pre class="highlight"><code>spec:
  resources:
    limits:
      cpu: 500m
      memory: 2Gi
    requests:
      cpu: 100m
      memory: 1Gi</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more examples visit:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://kubernetes.io/docs/tasks/configure-pod-container/assign-cpu-resource/" class="bare">https://kubernetes.io/docs/tasks/configure-pod-container/assign-cpu-resource/</a></p>
</li>
<li>
<p><a href="https://kubernetes.io/docs/tasks/configure-pod-container/assign-memory-resource/" class="bare">https://kubernetes.io/docs/tasks/configure-pod-container/assign-memory-resource/</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="storage">Specify the Storage Requirements for the Server Data Directory</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>storage</code> defines the storage requirements for WildFly&#8217;s own data.
The application may require persistent storage for some data (e.g. transaction or messaging logs) that must persist across Pod restarts.</p>
</div>
<div class="paragraph">
<p>If the <code>storage</code> spec is empty, an <code>EmptyDir</code> volume will be used by each pod of the application (but this volume will not persist after its corresponding pod is stopped).</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Using the <code>EmptyDir</code> is especially unsafe for XA transaction processing.
When the application uses the XA transactions then is required to configure the persistent volume claim (example below)
or configure the transaction subsystem to store transaction log in database with
<a href="https://docs.wildfly.org/23/wildscribe/subsystem/transactions/index.html#attr-use-jdbc-store">use of JDBC store</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A <code>volumeClaimTemplate</code> can be specified to configure <code>Resources</code> requirements to store WildFly standalone data directory.
The name of the template is derived from the <code>WildFlyServer</code> name. The corresponding volume will be mounted in <code>ReadWriteOnce</code> access mode.</p>
</div>
<div class="paragraph">
<p>The <code>storage</code> spec is defined in the <a href="./apis.adoc#StorageSpec">StorageSpec API Documentation</a>.</p>
</div>
<div class="listingblock">
<div class="title">Example of storage requirement</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spec:
  storage:
    volumeClaimTemplate:
      spec:
        resources:
          requests:
            storage: 3Gi</code></pre>
</div>
</div>
<div class="paragraph">
<p>The persistent volume that meets this storage requirement is mounted on the <code>/wildfly/standalone/data</code> directory (corresponding to WildFly&#8217;s <code>jboss.server.data.dir</code> path).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="env">Configure the Application Environment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Environment can be configured using the <code>env</code> spec.
Environment variables can come directly from values (such as the <code>POSTGRESQL_SERVICE_HOST</code> example below) or from secrets (e.g. the <code>POSTGRESQL_USER</code> example below).</p>
</div>
<div class="listingblock">
<div class="title">Example of environment configuration</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spec:
  env:
  - name: POSTGRESQL_SERVICE_HOST
    value: postgresql
  - name: POSTGRESQL_SERVICE_PORT
    value: '5432'
  - name: POSTGRESQL_DATABASE
    valueFrom:
      secretKeyRef:
        key: database-name
        name: postgresql
  - name: POSTGRESQL_USER
    valueFrom:
      secretKeyRef:
        key: database-user
        name: postgresql
  - name: POSTGRESQL_PASSWORD
    valueFrom:
      secretKeyRef:
        key: database-password
        name: postgresql</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="secret">Configure Secrets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Secrets can be mounted as volumes to be accessed from the application.</p>
</div>
<div class="paragraph">
<p>The secrets must be created <strong>before</strong> the WildFly Operator deploys the application. For example we can create a secret named <code>my-secret</code> with a command such as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ kubectl create secret generic my-secret --from-literal=my-key=devuser --from-literal=my-password='my-very-secure-pasword'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the secret has been created, we can specify its name in the WildFlyServer Spec to have it mounted as a volume in the pods running the application:</p>
</div>
<div class="listingblock">
<div class="title">Example of mounting secrets</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spec:
  secrets:
    - my-secret</code></pre>
</div>
</div>
<div class="paragraph">
<p>The secrets will then be mounted under <code>/etc/secrets/&lt;secret name&gt;</code> and each key/value will be stored in a file (whose name is the key and the content is the value).</p>
</div>
<div class="listingblock">
<div class="title">Secret is mounted as a volume inside the Pod</div>
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">[jboss@quickstart-0 ~]$ ls /etc/secrets/my-secret/
my-key  my-password
[jboss@quickstart-0 ~]$ cat /etc/secrets/my-secret/my-key
devuser
[jboss@quickstart-0 ~]$ cat /etc/secrets/my-secret/my-password
my-very-secure-pasword</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configmaps">Configure ConfigMaps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ConfigMaps can be mounted as volumes to be accessed from the application.</p>
</div>
<div class="paragraph">
<p>The config maps must be created <strong>before</strong> the WildFly Operator deploys the application. For example we can create a config map named <code>my-config</code> with a command such as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ kubectl create configmap my-config --from-literal=key1=value1 --from-literal=key2=value2
configmap/my-config created</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the config map has been created, we can specify its name in the WildFlyServer Spec to have it mounted as a volume in the pods running the application:</p>
</div>
<div class="listingblock">
<div class="title">Example of mounting config maps</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spec:
  configMaps:
  - my-config</code></pre>
</div>
</div>
<div class="paragraph">
<p>The config maps will then be mounted under <code>/etc/configmaps/&lt;config map name&gt;</code> and each key/value will be stored in a file (whose name is the key and the content is the value).</p>
</div>
<div class="listingblock">
<div class="title">Config Map is mounted as a volume inside the Pod</div>
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">[jboss@quickstart-0 ~]$ ls /etc/configmaps/my-config/
key1 key2
[jboss@quickstart-0 ~]$ cat /etc/configmaps/my-config/key1
value1
[jboss@quickstart-0 ~]$ cat /etc/configmaps/my-config/key2
value2</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="standalone-config-map">Bring Your Own Standalone XML Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is possible to directly provide WildFly standalone configuration instead of the one in the application image (that comes from WildFly S2I).</p>
</div>
<div class="paragraph">
<p>The standalone XML file must be put in a ConfigMap that is accessible by the operator.
The <code>standaloneConfigMap</code> must provide the <code>name</code> of this ConfigMap as well as the <code>key</code> corresponding to the name of standalone XML file.</p>
</div>
<div class="listingblock">
<div class="title">Example of bringing its own standalone configuration</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spec:
  standaloneConfigMap:
    name: clusterbench-config-map
    key: standalone-openshift.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the <code>clusterbench-config-map</code> must be created <strong>before</strong> the WildFly Operator deploys the application.</p>
</div>
<div class="listingblock">
<div class="title">Example of creating a ConfigMap from a standalone XML file</div>
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ kubectl create configmap clusterbench-config-map --from-file examples/clustering/config/standalone-openshift.xml
configmap/clusterbench-config-map created</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This feature is not supported by a Bootable JAR application image. If you enabled it, your application image will not be deployed in the cluster.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitor_wildfly_metrics">Monitor WildFly Metrics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If the Prometheus Operator is deployed on the cluster (and the <code>ServiceMonitor</code> Custom Resource Definition is installed), the WildFly operator automatically creates a <code>ServiceMonitor</code> to expose its metrics to Prometheus.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_openshift_features">OpenShift Features</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some Operator features are only available when running on OpenShift if Kubernetes does not provide the required resources to activate these features.</p>
</div>
<div class="sect2">
<h3 id="seamless-upgrades">Seamless Upgrades</h3>
<div class="paragraph">
<p>On OpenShift, it is possible to use an imagestream tag for the <code>applicationImage</code> to provide seamless upgrades.</p>
</div>
<div class="paragraph">
<p>The imagestream must be in the same namespace that the deployed <code>WildFlyServer</code> resource.
If that&#8217;s the case, the WildFly Operator will trigger new deployment of the application whenever the image corresponding to the imagestream tag changes.</p>
</div>
<div class="paragraph">
<p>This allows to take full advantage of the OpenShift ecosystem to build the image using <code>BuildConfig</code> in order to trigger new deployments when the code of the application changes (using WebHooks to trigger new builds and then new deployments) or when WildFly S2I images changes (which can also trigger new build).</p>
</div>
</div>
<div class="sect2">
<h3 id="http-route-creation">Creation of an HTTP Route</h3>
<div class="paragraph">
<p>By default, when the Operator runs on OpenShift, it creates an external route to the HTTP port of the Java application.</p>
</div>
<div class="paragraph">
<p>This route creation can be disabled by setting <code>disableHTTPRoute</code> to <code>true</code> if you do not wish to create an external route to the Java application.</p>
</div>
<div class="listingblock">
<div class="title">Example to disable HTTP route</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spec:
  disableHTTPRoute: true</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="scaledown-transaction-recovery">Transaction recovery during scaledown</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As the application deployed in the WildFly application server
may use JTA transactions there and the question emerges: what does happen when the cluster is scaled down?
When the number of active WildFly replicas is decreased, still there may be some in-doubt transactions in the transaction log.
When the pod is removed then all the in-progress transactions are stopped and rolled back.
A more troublesome situation occurs when XA transactions are used.
When the XA transaction declares it&#8217;s prepared it&#8217;s a promise to finish the transaction successfully.
But the transaction manager which made this promise is running inside the WildFly server.
Then simply shutting down such pod may lead to data inconsistencies or data locks.</p>
</div>
<div class="paragraph">
<p>It must be ensured that all transactions are finished before the number of replicas is really decreased.
For that purpose, the WildFly Operator provides scale down functionality which verifies if all transactions were finished
and only then marks the pod as clean for termination.</p>
</div>
<div class="paragraph">
<p>Decreasing the replica size in the <code>WildFlyServer</code> customer resource is done at field <code>WildFlyServer.Spec.Replicas</code> (see <a href="#size">Specify the Size of the Application</a>).
You can use for example patch command like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>oc patch wildflyserver &lt;name&gt; -p '[{"op":"replace", "path":"/spec/replicas", "value":0}]' --type json</code></pre>
</div>
</div>
<div class="paragraph">
<p>or you can manually edit and change the replica number with <code>oc edit wildflyserver &lt;name&gt;</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Decreasing replica size at the <code>StatefulSet</code> or deleting the Pod itself has no effect and as such changes will be reverted.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
if you decide to delete whole <code>WildflyServer</code> definition (<code>oc delete wildflyserver &lt;deployment_name&gt;</code>)
         then no transaction recovery process is started and the pod is terminated regardless of unfinished transactions.
         If you want to remove the deployment in a safe way without data inconsistencies,
         you need first to scale down the number of pods to 0, wait until all pods are terminated
         and only after that you can delete the <code>WildFlyServer</code> instance
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Narayana recovery listener has to be enabled in the WildFly transaction subsystem.
         Otherwise, scaledown transaction recovery processing is skipped for the particular WildFly pod.
         See the <a href="https://wildscribe.github.io/WildFly/18.0/subsystem/transactions/index.html"><code>recovery-listener</code> attribute of the transaction subsystem</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>when the scaledown process begins the pod state (<code>oc get pod &lt;pod_name&gt;`</code>) is still marked as <code>Running</code>.
The reason is that the pod needs to be able to finish all the unfinished transactions and which includes the remote EJB calls that target it.
If you want to observe the state of the scaledown processing you need to observe the status of the <code>WildFlyServer</code> instance.
When running <code>oc describe wildflyserver &lt;name&gt;</code> you can see the status of the Pods.</p>
</div>
<div class="paragraph">
<p>The <code>WildFlyServer.Status.Pods[].State</code> can be one of the following values:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Status.Pod.State</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ACTIVE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pod is active and processing requests.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCALING_DOWN_RECOVERY_INVESTIGATION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pod is under investigation to find out if there are transactions that did not complete their lifecycle successfully.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCALING_DOWN_RECOVERY_PROCESSING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">There are in-doubt transactions in the log store. The pod cannot be terminated until these transactions are either completed or cleaned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCALING_DOWN_RECOVERY_HEURISTICS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">There are heuristic transactions in the log store. The pod cannot be terminated until these transactions are either completed or cleaned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCALING_DOWN_CLEAN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pod was processed by transaction scaled down processing and is marked as clean to be removed from the cluster.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For pods in the <code>SCALING_DOWN_RECOVERY_PROCESSING</code> status, each recovery cycle is tracked using the <code>RecoveryCounter</code> (accessible via <code>WildFlyServer.Status.Pods[].RecoveryCounter</code>). This field monitors the operator&#8217;s recovery attempts until all in-doubt transactions are successfully completed.</p>
</div>
<div class="paragraph">
<p>You can observe the overall state of the active and no-active pods by looking at the
<code>WildFlyServer.Status.'Scalingdown Pods'</code> and <code>WildFlyServer.Status.Replicas</code> fields.
The <code>'Scalingdown Pods'</code> defines the number of pods which are about to be terminated when they are clean of unfinished transactions.
The <code>Replicas</code> defines the current number of running pods.
The <code>WildFlyServer.Spec.Replicas</code> (see <a href="#size">Specify the Size of the Application</a>) defines the desired number of the active pods.
If there are no pods in scaledown process the numbers of <code>WildFlyServer.Status.Replicas</code> and <code>WildFlyServer.Spec.Replicas</code> are equals.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This feature is not supported by a Bootable JAR application image. The transaction recovery facility will be ignored for Bootable JAR application images.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>It&#8217;s feasible to disable transaction recovery during scale-down by configuring the property <code>WildFlyServerSpec.DeactivateTransactionRecovery</code> to <code>true</code> (by default, it&#8217;s set to <code>false</code>). When <code>DeactivateTransactionRecovery</code> is enabled, in-doubt and heuristic transactions won&#8217;t be finalized or reported.
Consequently, this could lead to potential data inconsistency or loss when distributed transactions are employed.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_transaction_scaledown_special_cases">Transaction scaledown special cases</h3>
<div class="sect3">
<h4 id="_heuristics_transactions">Heuristics transactions</h4>
<div class="paragraph">
<p>As it&#8217;s well-known the transaction may finish either with commit or roll-back.
Unfortunately there is a third outcome which is <em>unknown</em>.
It’s a state when there is no way of automatic transaction recovery and human intervention is needed.
If the transaction is in state of heuristics the pod is marked as <code>SCALING_DOWN_RECOVERY_HEURISTICS</code>
and the administrator needs to manually connect with the <code>jboss-cli</code> to the particular WildFly instance
and to resolve the heuristic transaction.</p>
</div>
<div class="paragraph">
<p>When all the formerly heuristics records are removed from the transaction object store then the operator
marks the pod as <code>SCALING_DOWN_CLEAN</code> and the pod is terminated.</p>
</div>
</div>
<div class="sect3">
<h4 id="_scaling_down_clean_state_and_statefulset_behaviour">SCALING_DOWN_CLEAN state and StatefulSet behaviour</h4>
<div class="paragraph">
<p>There is a special case coming from the design of the <code>StatefulSet</code> that ensures that the network hostname is stable
(it does not change on the pod restart). The <code>StatefulSet</code> depends on ordering of the pods. The pod are named by the defined order.
The <code>StatefulSet</code> then requires the pod-0 not being terminated before the pod-1. First pod-1 is terminated and then pod-0.</p>
</div>
<div class="paragraph">
<p>From that rule we can observe that if the pod-1 is in state <code>SCALING_DOWN_RECOVERY_HEURISTICS</code> (e.g. contains some heuristic transactions)
then if pod-0 is in the state of <code>SCALING_DOWN_CLEAN</code> in will be lingering at that state until the pod-1 is terminated.</p>
</div>
<div class="paragraph">
<p>But even the pod is in state <code>SCALING_DOWN_CLEAN</code> the pod is not receiving any new requests
so it&#8217;s practically idle.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-05-21 14:20:14 UTC
</div>
</div>
</body>
</html>